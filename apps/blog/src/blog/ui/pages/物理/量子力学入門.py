import streamlit as st
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt

mpl.rcParams['font.family'] = 'Noto Sans CJK JP'


r"""
# 量子力学入門・前半

「0からLの間に量子が存在します。」

いま0からLの範囲に存在するっていったね！？

つまり0より前、Lより後ろには存在しないわけです

量子の存在確率は連続していなければならないという法則があります(唐突)

つまり$x=-0.000001$の位置では存在確率0％なのに、$x=0$で急に30%になるとかはありえません

量子の存在確率の確率密度関数は波の形をしているという物理法則があります(唐突)

確率密度関数は物理とは関係無い数学の概念です、とりあえずいろんな位置での存在確率を表す値をプロットすると、波のような形になるという物理法則があります(異論は認めない)

波というのは紐を振動させた時とか、海でみかける形のことで、以下の関数はそのような形をしています

$$
\frac{\partial^2 \psi}{\partial t^2} = a \frac{\partial^2 \psi}{\partial x^2}
$$

実はこの式の形が波っぽいというより、この式が波の定義です(波動方程式と呼ばれる)

とにかく量子の存在確率を表す確率密度関数は波動方程式であるという物理法則があります

以上を踏まえると、物理法則と前提条件を満たす波の形は以下の図のような感じ(どれでもいい)👇
"""


def plot_waves():
    L = 10  # x軸の範囲 (0, L)
    x = np.linspace(-2, L + 2, 500)

    # 波の式を計算 (パラメータはハードコード, 境界条件を満たすように調整)
    y1 = 2 * np.sin(1 * np.pi * x / L)  # 基本振動
    y1[x < 0] = 0
    y1[x > L] = 0

    y2 = 1.5 * np.sin(2 * np.pi * x / L)  # 2倍振動
    y2[x < 0] = 0
    y2[x > L] = 0

    y3 = 1 * np.sin(3 * np.pi * x / L)  # 3倍振動
    y3[x < 0] = 0
    y3[x > L] = 0

    # プロット
    fig = plt.figure(figsize=(10, 6))
    plt.plot(x, y1, linestyle="--", label="Wave 1")
    plt.plot(x, y2, linestyle="--", label="Wave 2")
    plt.plot(x, y3, linestyle="--", label="Wave 3")
    plt.xlabel("位置x")
    plt.ylabel("確率密度y")
    plt.xlim(-2, L + 2)
    plt.ylim(-3, 3)  # 振幅の最大値に合わせて調整

    # 軸の数字を非表示にする
    plt.xticks([])
    plt.yticks([])

    st.pyplot(fig)


# 関数の実行
plot_waves()

r"""
## まとめ

* 量子の存在確率は連続して変化する
* 量子の確率密度関数は波の形をしている
"""

r"""
# 量子力学入門・後半

## 🌊 波の形と量子の運動量・エネルギー

上で書いた **波の形**(確率密度関数の形) とその **量子の運動量やエネルギー** の間で、以下の式が成り立つという物理法則があります！(唐突)(異論は認めない)

$$
\begin{aligned}
p &= \hbar k \\
E &= \frac{p^2}{2m} = \frac{\hbar^2 k^2}{2m} \\
\end{aligned}
$$

ここで、

$$
\begin{aligned}
&p：\text{粒子の運動量} \\
&\hbar：1.054571817 \times 10^{-34}\text{J} \cdot \text{s}\text{ぐらいの定数} \\
&k：\text{波数} \ (k = \frac{2\pi}{\lambda}, \ \lambda\text{は波長}) \\
&E：\text{粒子のエネルギー} \\
&m：\text{粒子の質量}
\end{aligned}
$$

この式から、上の図の青色の確率密度関数の量子の運動量とか、確率密度関数が赤のときの量子のエネルギーとかが求まります。

また、波数は1個、2個と数えるので、上の式から運動量やエネルギーは離散的で最小値があるということがわかります。

すごい抽象的なんですけど、粒子がある範囲に存在するという仮定だけから粒子のエネルギーには最小値があることが物理法則によって導かれるのです。

ここから、物理量は離散的な場合があるという話になってきます。

---

## 💡 光の最小単位と波粒二重性

物理量が離散的というのはどういうことかというと、例えば光の明るさには最小単位があります。

無限にゼロに近づけることができるのが連続的で、その反対なので離散的ということです。

例えば光をどんどん暗くしていくと、最終的には光子1つずつが検出されるようになります。これ以上暗くしようとすると、光子が検出されない時間が増え、完全に光が消える状況が観測されます。これは、光が光子という最小単位でできていることを示しています。

ところで光は電磁波であり、振動方向に対して角度を付けた偏光子を通すと、その偏光子の角度によって一部が通過します。

例えば、縦に振動している電磁波を真横に向いた偏光子に通すと、その波は通過しません。

逆に振動方向と同じ向きの偏光子に通すと、波はそのまま通過します。

一般に、偏光子の透過軸と電磁波の振動方向が角度 $\theta$ をなす場合、$cos^2(\theta)$ の割合の電磁波が通過します。

これらの性質から、光（電磁波）は粒子としての性質と波としての性質を持つなどと表現されます。これを「波粒二重性」と呼びます。

---

## 🎲 光子の確率的な振る舞い

もし最小単位の光（光子）を偏光子に通すとどうなるでしょう。それ以上暗い光が存在しないので、「一部」が通過することはありません。

実はこの時、光は確率的に透過したり透過しなかったりします。ここで透過したときを「1」、透過しなかったときを「0」とすると、確率的に0や1の二通りの状態だけを取ります。

また、この時の透過確率は、わかった人もいるかもしれませんが$cos^2(\theta)$です。

---

## 🌍 例え話：2つの国の運命

急ですがこっから例え話します。

2つの国A, Bがあるとします、ここでAとBが全く同じような国だとします。

A,Bの両方に覚醒剤をばらまいたとします。この覚醒剤によって生産性は上がりますが、副作用で攻撃性が上がります。

この時A, Bはどうなるでしょうか？滅びるか栄えるかの二択ですね。

ここで、AとBはもともと全く同じような国だったことから、AかBか片方を観測すれば、もう片方の国の状態もわかりそうですよね。

Aが滅びていた場合Bも滅びていて、Aが栄えていた場合Bも栄えているという具合です。

---

## 🔗 量子の絡み合いと観測結果

例え話と似たような現象が量子にもおきます。

2つの量子を準備して特別な操作を加えると、片方の量子を観測した時にもう片方の量子の観測結果も全く同じになるという状況を作り出すことができます。

更に、偏光子の例で述べた通りこの観測結果は角度によって決まります。

片方の量子で角度を決めて観測した時に0または1になった時、もう片方の量子でも同じ角度で観測すると全く同じ結果になるということです。

これには更にトリッキーな性質があって、片方の量子で角度を決めて観測した時に0または1がわかると、もう片方の量子で角度を$\theta$ずらして観測すると、$cos^2(\theta)$の確率で元の量子と同じ結果になるといった現象が起こります。

これを量子のエンタングルメントといいます。

---

## 🧠 思考実験と局所実在性

全知であることを神の必要条件とすると、エンタングルメントを工夫して実験を行うことにより、神は存在しないことを証明することができます。

気を引くために大げさにいいましたが、実際局所実在性という物理学の基本的な仮定が破れることがわかり、未来は決まっていないことや、パラレルワールドみたいなとんでも理論が現実味を帯びてきます。

[CHSHゲームについて](CHSHゲーム) のリンクで思考実験の詳細を説明しています。

---

## まとめ

* 物理量は離散的
* 偏光子で確率的に0か1の状態を作れる
* 片方がわかればもう片方がわかるエンタングルメントという性質がある
* エンタングルメントを活用すれば一部の神の存在を否定できる

細かい計算は学校でならってください！簡単な理解は以上です。

量子力学やってて何が前提で何が導かれているのかさっぱりわからくなったことがあるので、同じような人の手助けになれば幸いです...orz
"""
