## Output
```
Initial loss: 2.3123507
Epoch 1/5: 100%|██████████| 118/118 [00:13<00:00,  8.63it/s]
Epoch 1: Average Loss = 0.6157775521278381
Epoch 2/5: 100%|██████████| 118/118 [00:08<00:00, 13.30it/s]
Epoch 2: Average Loss = 0.22774720191955566
Epoch 3/5: 100%|██████████| 118/118 [00:08<00:00, 13.47it/s]
Epoch 3: Average Loss = 0.17137962579727173
Epoch 4/5: 100%|██████████| 118/118 [00:08<00:00, 13.63it/s]
Epoch 4: Average Loss = 0.13709883391857147
Epoch 5/5: 100%|██████████| 118/118 [00:08<00:00, 13.61it/s]
Epoch 5: Average Loss = 0.11209221184253693
Training completed. Final model state:
0.11209221
Baysian optimization start.
|   iter    |  target   | hidden... | hidden... | learni... |
-------------------------------------------------------------
Initial loss: 2.3137894
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.13it/s]
Epoch 1: Average Loss = 4.1450910568237305
Validation loss (lr=0.0731996621871987, hidden1=211, hidden2=488): 4.1450910568237305
| 1         | -4.145    | 211.8     | 488.3     | 0.0732    |
Initial loss: 2.3321671
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.22it/s]
Epoch 1: Average Loss = 0.32410916686058044
Validation loss (lr=0.015600296039099928, hidden1=319, hidden2=106): 0.32410916686058044
| 2         | -0.3241   | 319.4     | 106.9     | 0.0156    |
Initial loss: 2.3330827
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.30it/s]
Epoch 1: Average Loss = 1.6977014541625977
Validation loss (lr=0.060111900059309144, hidden1=59, hidden2=447): 1.6977014541625977
| 3         | -1.698    | 59.88     | 447.8     | 0.06011   |
Initial loss: 2.3163192
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.28it/s]
Epoch 1: Average Loss = 2.763275384902954
Validation loss (lr=0.09699101530634728, hidden1=371, hidden2=41): 2.763275384902954
| 4         | -2.763    | 371.9     | 41.88     | 0.09699   |
Initial loss: 2.3234353
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  9.02it/s]
Epoch 1: Average Loss = 0.41462641954421997
Validation loss (lr=0.018183314895742857, hidden1=431, hidden2=133): 0.41462641954421997
| 5         | -0.4146   | 431.6     | 133.9     | 0.01818   |
Initial loss: 2.2998137
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.15it/s]
Epoch 1: Average Loss = 0.4229424297809601
Validation loss (lr=0.02338204949647332, hidden1=321, hidden2=110): 0.4229424297809601
| 6         | -0.4229   | 321.2     | 110.2     | 0.02338   |
Initial loss: 2.2994008
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.26it/s]
Epoch 1: Average Loss = 2.204457998275757
Validation loss (lr=0.0819413272014111, hidden1=263, hidden2=97): 2.204457998275757
| 7         | -2.204    | 264.0     | 97.49     | 0.08194   |
Initial loss: 2.3180013
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.16it/s]
Epoch 1: Average Loss = 3.1419577598571777
Validation loss (lr=0.07316488328345236, hidden1=390, hidden2=148): 3.1419577598571777
| 8         | -3.142    | 390.1     | 148.9     | 0.07316   |
Initial loss: 2.3086827
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.24it/s]
Epoch 1: Average Loss = 1.671608567237854
Validation loss (lr=0.06038575609888851, hidden1=458, hidden2=125): 1.671608567237854
| 9         | -1.672    | 458.7     | 125.4     | 0.06039   |
Initial loss: 2.3071284
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  8.87it/s]
Epoch 1: Average Loss = 1.256033182144165
Validation loss (lr=0.05457824046109374, hidden1=332, hidden2=85): 1.256033182144165
| 10        | -1.256    | 332.6     | 85.86     | 0.05458   |
Initial loss: 2.2946875
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.10it/s]
Epoch 1: Average Loss = 0.2743774652481079
Validation loss (lr=0.009097740713809916, hidden1=424, hidden2=109): 0.2743774652481079
| 11        | -0.2744   | 424.7     | 109.4     | 0.009098  |
Initial loss: 2.317873
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  9.06it/s]
Epoch 1: Average Loss = 0.7297729849815369
Validation loss (lr=0.04121235003120042, hidden1=439, hidden2=76): 0.7297729849815369
| 12        | -0.7298   | 439.3     | 76.26     | 0.04121   |
Initial loss: 2.3128498
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.19it/s]
Epoch 1: Average Loss = 0.946134090423584
Validation loss (lr=0.048145650638185815, hidden1=472, hidden2=48): 0.946134090423584
| 13        | -0.9461   | 472.7     | 48.19     | 0.04815   |
Initial loss: 2.2876186
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  9.05it/s]
Epoch 1: Average Loss = 8.035195350646973
Validation loss (lr=0.09794123766630679, hidden1=298, hidden2=140): 8.035195350646973
| 14        | -8.035    | 298.0     | 140.1     | 0.09794   |
Initial loss: 2.317506
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  8.93it/s]
Epoch 1: Average Loss = 0.3839266002178192
Validation loss (lr=0.0017772023543374306, hidden1=407, hidden2=82): 0.3839266002178192
| 15        | -0.3839   | 407.0     | 82.83     | 0.001777  |
Initial loss: 2.2964315
Epoch 1/1: 100%|██████████| 118/118 [00:11<00:00,  9.96it/s]
Epoch 1: Average Loss = 0.36535024642944336
Validation loss (lr=0.0025030819425186997, hidden1=429, hidden2=41): 0.36535024642944336
| 16        | -0.3654   | 429.9     | 41.29     | 0.002503  |
Initial loss: 2.326091
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  9.02it/s]
Epoch 1: Average Loss = 0.5480305552482605
Validation loss (lr=0.0005747817017286947, hidden1=446, hidden2=173): 0.5480305552482605
| 17        | -0.548    | 446.1     | 173.4     | 0.0005748 |
Initial loss: 2.3222997
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  9.01it/s]
Epoch 1: Average Loss = 0.2983846366405487
Validation loss (lr=0.0027493900223528466, hidden1=473, hidden2=200): 0.2983846366405487
| 18        | -0.2984   | 474.0     | 200.6     | 0.002749  |
Initial loss: 2.3144865
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  8.95it/s]
Epoch 1: Average Loss = 0.2725956439971924
Validation loss (lr=0.008772019387547438, hidden1=440, hidden2=213): 0.2725956439971924
| 19        | -0.2726   | 440.9     | 213.5     | 0.008772  |
Initial loss: 2.3307123
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  9.05it/s]
Epoch 1: Average Loss = 7.100915908813477
Validation loss (lr=0.09300431511243798, hidden1=471, hidden2=240): 7.100915908813477
| 20        | -7.101    | 471.3     | 240.8     | 0.093     |
Initial loss: 2.311585
Epoch 1/1: 100%|██████████| 118/118 [00:12<00:00,  9.09it/s]
Epoch 1: Average Loss = 0.2708035409450531
Validation loss (lr=0.008377656906364616, hidden1=485, hidden2=174): 0.2708035409450531
| 21        | -0.2708   | 485.1     | 174.1     | 0.008378  |
Initial loss: 2.3220866
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  8.92it/s]
Epoch 1: Average Loss = 0.6298381090164185
Validation loss (lr=0.026074908072006773, hidden1=415, hidden2=198): 0.6298381090164185
| 22        | -0.6298   | 415.8     | 198.6     | 0.02607   |
Initial loss: 2.3088174
Epoch 1/1: 100%|██████████| 118/118 [00:14<00:00,  8.34it/s]
Epoch 1: Average Loss = 0.27910372614860535
Validation loss (lr=0.004164792778163996, hidden1=406, hidden2=234): 0.27910372614860535
| 23        | -0.2791   | 406.7     | 234.1     | 0.004165  |
Initial loss: 2.324307
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  8.72it/s]
Epoch 1: Average Loss = 1.4212507009506226
Validation loss (lr=0.050229294385521, hidden1=370, hidden2=233): 1.4212507009506226
| 24        | -1.421    | 370.3     | 233.8     | 0.05023   |
Initial loss: 2.30154
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  8.73it/s]
Epoch 1: Average Loss = 0.3082907497882843
Validation loss (lr=0.002389326179179107, hidden1=510, hidden2=191): 0.3082907497882843
| 25        | -0.3083   | 510.5     | 191.8     | 0.002389  |
Initial loss: 2.3087301
Epoch 1/1: 100%|██████████| 118/118 [00:16<00:00,  7.12it/s]
Epoch 1: Average Loss = 6.22697639465332
Validation loss (lr=0.09692174218370951, hidden1=509, hidden2=151): 6.22697639465332
| 26        | -6.227    | 509.7     | 151.6     | 0.09692   |
Initial loss: 2.3307073
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  8.56it/s]
Epoch 1: Average Loss = 0.4607982635498047
Validation loss (lr=0.01991350785945427, hidden1=399, hidden2=268): 0.4607982635498047
| 27        | -0.4608   | 399.3     | 268.3     | 0.01991   |
Initial loss: 2.3312104
Epoch 1/1: 100%|██████████| 118/118 [00:14<00:00,  8.14it/s]
Epoch 1: Average Loss = 4.115870475769043
Validation loss (lr=0.06641698631276291, hidden1=371, hidden2=290): 4.115870475769043
| 28        | -4.116    | 371.3     | 290.7     | 0.06642   |
Initial loss: 2.2948873
Epoch 1/1: 100%|██████████| 118/118 [00:14<00:00,  8.38it/s]
Epoch 1: Average Loss = 1.4448083639144897
Validation loss (lr=0.050483709150074274, hidden1=376, hidden2=100): 1.4448083639144897
| 29        | -1.445    | 376.1     | 100.7     | 0.05048   |
Initial loss: 2.3489451
Epoch 1/1: 100%|██████████| 118/118 [00:13<00:00,  8.77it/s]
Epoch 1: Average Loss = 1.0234999656677246
Validation loss (lr=0.03909036270240408, hidden1=421, hidden2=258): 1.0234999656677246
| 30        | -1.023    | 421.4     | 258.6     | 0.03909   |
=============================================================
Best parameters found: {'target': np.float64(-0.2708035409450531), 'params': {'hidden_size_1': np.float64(485.14852190119484), 'hidden_size_2': np.float64(174.1198464063595), 'learning_rate': np.float64(0.008377656906364616)}}
Initial loss: 2.311585
Epoch 1/5: 100%|██████████| 118/118 [00:09<00:00, 13.07it/s]
Epoch 1: Average Loss = 0.2708035409450531
Epoch 2/5: 100%|██████████| 118/118 [00:10<00:00, 11.65it/s]
Epoch 2: Average Loss = 0.08949209004640579
Epoch 3/5: 100%|██████████| 118/118 [00:10<00:00, 10.79it/s]
Epoch 3: Average Loss = 0.06113035976886749
Epoch 4/5: 100%|██████████| 118/118 [00:09<00:00, 12.44it/s]
Epoch 4: Average Loss = 0.05003752186894417
Epoch 5/5: 100%|██████████| 118/118 [00:10<00:00, 11.61it/s]
Epoch 5: Average Loss = 0.046506889164447784
Final evaluation with best parameters (5 epochs):
Final loss: 0.04650689
```

## 考察
```python
import math
import numpy as np

# この問題は、MNISTのような10クラス分類におけるクロスエントロピー損失を考えている。
# クロスエントロピー損失は次の式で定義される:
#    loss = - (1/N) * sum_i sum_c [ y_ic * log(p_ic) ]
# ここで、y_icは正解クラスを1とするone-hot表現、p_icはモデルが出力する確率。
#
# 完全にランダムな予測（全クラスに均等な確率1/10）の場合、
# 正解クラスに割り当てられる確率は 1/10 であるため、損失は:
#    loss_random = -log(1/10) = log(10)
# となり、約 2.3026 となる。

loss_random = math.log(10)
print("ランダム予測時の期待損失 (log(10)):", loss_random)  # ≒2.3026

# 実際に報告された初期の誤差が約2.31であるため、
# これはモデルが最初はほぼランダムな予測をしていたことを示す。

# 一方、最終的な損失が0.046となったということは、
# 平均して -log(p_correct) ≒ 0.046 となるので、正解クラスに割り当てられる確率は:
p_correct = np.exp(-0.046)
print("最終損失0.046に対応する正解クラスの確率:", p_correct)  # ≒0.955

# この値から、モデルは入力に対して約95.5%の確信度で正しいクラスを予測していると解釈できる。
#
# まとめると：
# - 初期の損失約2.31は、10クラスにおけるランダム予測の理論値（≈2.3026）に近く、
#   学習開始前は全く情報を持っていなかったことを示す。
# - 最終的な損失0.046は、モデルが各入力について非常に高い確率（約95.5%）で正しいクラスを出力していることを意味する。
#
# ただし、この損失はトレーニングデータに対するものであり、
# テストデータに対する汎化性能も確認する必要がある点に注意が必要。
```
