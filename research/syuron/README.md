# syuron

シミュレーションデータを基にして設計空間を近似するのをサロゲートモデルというらしい
機械学習で逆設計
shgのシミュレーションはpythonで行う

# 順方向の計算は転送行列法ですぐ終わる

1. 一個消去するとNCMEが一個に二階の微分方程式になる、それを解くとL^2の関数がでてくる、それが一つのドメイン
2. 転送行列で計算すると、異なる幅のドメインを通して、電界の位相と振幅が変化

# 参考文献
* https://chatgpt.com/share/67d2ab46-c6b0-800b-a3fb-1cf1c48c0878
* https://www.mdpi.com/2673-3269/5/1/9#:~:text=training%20an%20artificial%20neural%20network,in%20comparison%20with

# Idea
* 分極反転幅構造だけでなく、材料の屈折率の波長依存性もコントロールが可能であり、それの探索でLLM-SRできるかもしれない。どんな波長依存性を持つ材料を使えばいいのかについて探索できそう。phase_mismatchの波長依存性が変化してフラットやより特殊なスペクトル分布を作れそう。

# TODO
* 入出力ひっくり返してみる
* MNIST と同じ条件のデータ作ってみる
* https://web.wakayama-u.ac.jp/~ntakayuk/palmtree-j.htm (NN以外もいろいろあるっぽい)
* tanh の 条件で検算してみるといいらしい、基本波が減衰する条件
* 今使ってる微分方程式の形はこれでもシンプルなモデル考えてるらしい、完全な式は佐藤くんにきけばいいらしい
* 波長範囲と矩形幅と$\kappa$と決め打ちするドメイン構造の詳細について質問して決める
* 時間ないからすぐできそうな屈折率の方を先やりたい、そっちの条件になに設定するべきか決める
* 性能的にollama動かして分布も計算するのは無理なので、geminiのAPI課金してもらえないか聞く、分布計算はローカルでやればいい

# 修論TODO
* 周期とチャープとNPDA使えない条件の３つで検算をする
* 計算方法の詳しい説明スライドを先生と相談しながらつくる
* 探索がちゃんとできるのかどうかfunsearchのpocを作る
* 実際に探索を行う
* LLMには単なる数式だけでなく、幅配列をアルゴリズムによって生成してもらうことを考える
* AlphaEvolveのように、比較用の評価以上のevaluate結果を探索側に渡せるようにし、LLMへのプロンプトに使用する

# Modules

## mgoslt

## train
* gen_dataset
* train
    * model
    * hyper_params
* preprocess

# TODO
* デバイス構造を楽に生成するためのモジュール欲しい
* 出力の値を規格化するか整数にしてやらんと、今の教師データは1E-6とかのスケールだから学習しにくい
* 遺伝的アルゴリズムがいいっぽい
* GNN試したい
* 分布を学習するのではなく、変換効率の数字を学習する。この時、対応する波長も入力に含める
* 誤差関数やデータのpreprocessでフーリエ変換をしてみるのありかも
* ラフな絵で説明のための図を書いて先生に見せて確認をとり、発表資料を作る
* 今の計算で0.5秒ぐらいで分布かけるので、オプティマイザで構造みつける
* オプティマイザで見つける
    * デバイス形状振る時の条件考えなあかん、関数形か配列形かどっちもあり得る
        * 5つの周期分極反転構造を並べる
        * それぞれの、ブロックの全長が変数でドメイン数は定数
        * それぞれのduty比も変数
* オプティマイザと進化的アルゴリズムの組み合わせが気に入ってるけど、両方出番がある探し方なんか思いついてほしい


## Memo
* フーリエ変換でエンコード、逆フーリエ変換でデコード
* ドメイン数が100の時だけ、フーリエ級数展開が30個程度できれいにフィッティングできる

## その他・ウエムー
* グラフの正当性を検証する
* プロトン交換導波路を使うから作り方等考えとく
* デバイスの作り方の計画を立てる
* デバイス図のドメインの数を増やす
* 式の下に図が欲しい
* 波長を固定して幅配列を入力、変換効率を一つだけ出力するモデルを考えてみる

光源どうするか考える

4月に講習受ける

作製を同時並行で行う

* adamオプティマイザで直接幅配列見つけられる気がしてきた
* MgO:SLT使って広帯域化するとして、その時の具体的な変換効率を計算して、ちゃんと有効な効率を持ってるか確認しとく必要がある
* 既存の用途の上位互換です or 新しいこのような用途が考えられますという理由付けが必要
* 吸収帯以外は大体変換できるのでその範囲で用途探す
* 入射レーザが存在するか確認する、ないと使い道ない
* 位相を調整するのは分かりやすい効果なのでモデルを作れる、無駄にグリッドサーチはしない
* 3セグの400本のランダムフォレスト使うと広帯域な構造をミリ秒で出せるモデルが作れるらしい
* 5セグで苦労してるらしい
* 傾向があきらからしいから、その主張のための検証結果を持ってくれば、機械学習しますっていう話に持っていける
* スペクトルに情報を持たせると各波長がbitみたいになって、並列計算ができる
* スペクトルを調節できればうれしい
* 中心波長をずらした構造をくっ付けてサイドのでっぱりもいい感じになくしてひろい広帯域化できるかも
* デルタの位相の調整か、周期の調整か、どっちを先にやるか、交互にやってくと良いのか
* InGaAsを直接変換することが、ひろい位相整合スペクトルのニーズ、それができればYaGは不要
* 銅の加工かレーザ直接描画 (変換効率は落ちるのか？)

# Memo
シンプルに理想的な矩形波との二乗誤差とすると関数同定が使える
スコアが高い関数を探す⇔いろんなベクトルで内積結果を観測して最大の内積を与える関数を見つける

# 理論
ソボレフ空間を使うと窓付矩形波のよこすらいどをパラメータ$\Theta$として
空間上で関数のL^2ノルムが微分できるらしい？何言ってんのかわからない
